{"version":3,"file":"accordion.min.js","sources":["../src/accordion.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * This file contains an AMD/jQuery module to expand and collapse course rubrics.\n *\n * @package    block_filtered_course_list\n * @copyright  2016 CLAMP\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery', 'block_filtered_course_list/cookie'], function($, cookie) {\n\n    /**\n     * Expand a rubric.\n     *\n     * @function expandRubric\n     * @param {Element} rubric\n     * @param {Integer} persist\n     */\n    function expandRubric(rubric, persist) {\n        $(rubric).removeClass('block-fcl__rubric--collapsed');\n        $(rubric).addClass('block-fcl__rubric--expanded');\n        $(rubric).attr('aria-expanded', 'true');\n        $(rubric).next().attr('aria-hidden', 'false');\n        if (persist == 1) {\n            cookie.set(rubric.dataset.hash, 'expanded');\n        }\n    }\n\n    /**\n     * Collapse a rubric.\n     *\n     * @function collapseRubric\n     * @param {Element} rubric\n     * @param {Integer} persist\n     */\n    function collapseRubric(rubric, persist) {\n        $(rubric).removeClass('block-fcl__rubric--expanded');\n        $(rubric).addClass('block-fcl__rubric--collapsed');\n        $(rubric).attr('aria-expanded', 'false');\n        $(rubric).next().attr('aria-hidden', 'true');\n        if (persist == 1) {\n            cookie.set(rubric.dataset.hash, 'collapsed');\n        }\n    }\n\n    return {\n        init: function(params) {\n            var blockid = params.blockid;\n            $('#' + blockid + ' .block-fcl__rubric').each(function() {\n                var state = cookie.get(this.dataset.hash);\n                if (!($(this).hasClass('block-fcl__rubric--expanded')) && (!state || state == 'collapsed')) {\n                    collapseRubric(this, params.persist);\n                }\n                $(this).wrapInner(document.createElement('a'));\n                $(this).find('a').attr('href', '#');\n                $(this).on('click', function(event) {\n                    event.preventDefault();\n                    $('.block-fcl__rubric').each(function() {\n                        $(this).attr('aria-selected', 'false');\n                    });\n                    $(this).attr('aria-selected', 'true');\n                    if ($(this).hasClass('block-fcl__rubric--collapsed')) {\n                        expandRubric(this, params.persist);\n                    } else if ($(this).hasClass('block-fcl__rubric--expanded')) {\n                        collapseRubric(this, params.persist);\n                    }\n                });\n            });\n        }\n    };\n});\n"],"names":["define","$","cookie","collapseRubric","rubric","persist","removeClass","addClass","attr","next","set","dataset","hash","init","params","blockid","each","state","get","this","hasClass","wrapInner","document","createElement","find","on","event","preventDefault"],"mappings":";;;;;;;AAsBAA,OAAM,uCAAC,CAAC,SAAU,qCAAsC,SAASC,EAAGC,QA0BhE,SAASC,eAAeC,OAAQC,SAC5BJ,EAAEG,QAAQE,YAAY,+BACtBL,EAAEG,QAAQG,SAAS,gCACnBN,EAAEG,QAAQI,KAAK,gBAAiB,SAChCP,EAAEG,QAAQK,OAAOD,KAAK,cAAe,QACtB,GAAXH,SACAH,OAAOQ,IAAIN,OAAOO,QAAQC,KAAM,YAExC,CAEA,MAAO,CACHC,KAAM,SAASC,QACX,IAAIC,QAAUD,OAAOC,QACrBd,EAAE,IAAMc,QAAU,uBAAuBC,KAAK,WAC1C,IAAIC,MAAQf,OAAOgB,IAAIC,KAAKR,QAAQC,MAC9BX,EAAEkB,MAAMC,SAAS,gCAAqCH,OAAkB,aAATA,OACjEd,eAAegB,KAAML,OAAOT,SAEhCJ,EAAEkB,MAAME,UAAUC,SAASC,cAAc,MACzCtB,EAAEkB,MAAMK,KAAK,KAAKhB,KAAK,OAAQ,KAC/BP,EAAEkB,MAAMM,GAAG,QAAS,SAASC,OArCzC,IAAsBtB,OAAQC,QAsCdqB,MAAMC,iBACN1B,EAAE,sBAAsBe,KAAK,WACzBf,EAAEkB,MAAMX,KAAK,gBAAiB,QAClC,GACAP,EAAEkB,MAAMX,KAAK,gBAAiB,QAC1BP,EAAEkB,MAAMC,SAAS,iCA3CfhB,OA4CWe,KA5CHd,QA4CSS,OAAOT,QA3C1CJ,EAAEG,QAAQE,YAAY,gCACtBL,EAAEG,QAAQG,SAAS,+BACnBN,EAAEG,QAAQI,KAAK,gBAAiB,QAChCP,EAAEG,QAAQK,OAAOD,KAAK,cAAe,SACtB,GAAXH,SACAH,OAAOQ,IAAIN,OAAOO,QAAQC,KAAM,aAuCbX,EAAEkB,MAAMC,SAAS,gCACxBjB,eAAegB,KAAML,OAAOT,QAEpC,EACJ,EACJ,EAER"}